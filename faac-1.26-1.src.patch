diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/faac/common/Makefile.am src/faac/common/Makefile.am
--- origsrc/faac/common/Makefile.am	2004-07-28 03:18:21.000000000 -0500
+++ src/faac/common/Makefile.am	2007-10-14 16:31:20.015625000 -0500
@@ -1,4 +1,4 @@
-if WITH_MP4V2
+if WITH_MP4V2_INTERNAL
 SUBDIRS = mp4v2
 else
 SUBDIRS =
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/faac/configure.in src/faac/configure.in
--- origsrc/faac/configure.in	2007-08-20 13:03:22.000000000 -0500
+++ src/faac/configure.in	2007-10-14 16:34:54.031250000 -0500
@@ -8,7 +8,7 @@
 AC_ARG_WITH( mp4v2,  [  --with-mp4v2            compile libmp4v2],WITHMP4V2=$withval, WITHMP4V2=yes)
 AC_ARG_ENABLE( drm,  [  --enable-drm            Digital Radio Mondiale support], enable_drm=$enableval, enable_drm=no)
 
-AC_DEFUN(MY_DEFINE, [ AC_DEFINE($1, 1, [define if needed]) ])
+AC_DEFUN([MY_DEFINE], [ AC_DEFINE($1, 1, [define if needed]) ])
 
 CFLAGS=${CFLAGS:-"-O2 -Wall"}
 
@@ -27,7 +27,8 @@
 
 AC_CHECK_LIB(gnugetopt, getopt_long)
 
-AM_CONDITIONAL(WITH_MP4V2, false)
+AM_CONDITIONAL(WITH_MP4V2_INTERNAL, false)
+AM_CONDITIONAL(WITH_MP4V2_EXTERNAL, false)
 
 AC_CHECK_DECLS([MP4Create, MP4MetadataDelete],
                AC_CHECK_LIB(mp4v2, MP4MetadataDelete, external_mp4v2=yes,
@@ -36,10 +37,12 @@
 
 if test x$external_mp4v2 = xyes; then
   AC_MSG_NOTICE([*** Building with external mp4v2 ***])
+  AM_CONDITIONAL(WITH_MP4V2_EXTERNAL, true)
+  MY_DEFINE(HAVE_LIBMP4V2)
 else
   if test x$WITHMP4V2 = xyes; then
      AC_MSG_NOTICE([*** Building with internal mp4v2 ***])
-     AM_CONDITIONAL(WITH_MP4V2, true)
+     AM_CONDITIONAL(WITH_MP4V2_INTERNAL, true)
      AC_CONFIG_LINKS(common/mp4v2/mpeg4ip_config.h:config.h)
      MY_DEFINE(HAVE_LIBMP4V2)
   else
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/faac/frontend/Makefile.am src/faac/frontend/Makefile.am
--- origsrc/faac/frontend/Makefile.am	2004-07-28 03:18:21.000000000 -0500
+++ src/faac/frontend/Makefile.am	2007-10-14 16:34:07.593750000 -0500
@@ -2,10 +2,18 @@
 
 faac_SOURCES = main.c input.c
 
-if WITH_MP4V2
-INCLUDES = -I$(top_srcdir)/include -I$(top_srcdir)/common/mp4v2
-LDADD = $(top_builddir)/libfaac/libfaac.la $(top_srcdir)/common/mp4v2/libmp4v2.la -lm -lstdc++
+if WITH_MP4V2_INTERNAL
+MP4V2_CFLAGS = -I$(top_srcdir)/common/mp4v2
+MP4V2_LIBS = $(top_srcdir)/common/mp4v2/libmp4v2.la -lstdc++
 else
-INCLUDES = -I$(top_srcdir)/include 
-LDADD = $(top_builddir)/libfaac/libfaac.la -lm
+if WITH_MP4V2_EXTERNAL
+MP4V2_CFLAGS =
+MP4V2_LIBS = -lmp4v2
+else
+MP4V2_CFLAGS =
+MP4V2_LIBS =
+endif
 endif
+
+INCLUDES = -I$(top_srcdir)/include $(MP4V2_CFLAGS)
+LDADD = $(top_builddir)/libfaac/libfaac.la $(MP4V2_LIBS) -lm
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/faac/include/faac.h src/faac/include/faac.h
--- origsrc/faac/include/faac.h	2004-07-04 07:12:05.000000000 -0500
+++ src/faac/include/faac.h	2007-10-14 15:36:19.109375000 -0500
@@ -49,10 +49,6 @@
 
 typedef void *faacEncHandle;
 
-#ifndef HAVE_INT32_T
-typedef int int32_t;
-#endif
-
 /*
 	Allows an application to get FAAC version info. This is intended
 	purely for informative purposes.
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/faac/libfaac/Makefile.am src/faac/libfaac/Makefile.am
--- origsrc/faac/libfaac/Makefile.am	2007-08-20 13:03:23.000000000 -0500
+++ src/faac/libfaac/Makefile.am	2007-10-14 15:36:52.234375000 -0500
@@ -6,6 +6,7 @@
 endif
 libfaac_la_SOURCES = $(main_SOURCES) $(drm_SOURCES)
 libfaac_la_INCLUDES = aacquant.h channels.h filtbank.h hufftab.h psych.h backpred.h coder.h frame.h midside.h tns.h bitstream.h fft.h huffman.h ltp.h util.h
+libfaac_la_LDFLAGS = -no-undefined
 libfaac_la_LIBADD = -lm
 
 INCLUDES = -I$(top_srcdir)/include
